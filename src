package com.china3s.android.base.database;

import com.china3s.android.huodong.util.ActivityRemindDatabase;
import com.china3s.android.push.message.mode.PushMsgDatabase;

import android.content.Context;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;

/**
 * 春航移动数据库 注意：版本更新涉及到“增”“删”“更改”表时，需小心维护版本号DATABASE_VERSION和升级方法onUpgrade
 * 
 * @author ZHT
 * @date 2014年5月20日
 */
public class DataBaseHelper extends SQLiteOpenHelper {
	// 数据库文件名称
	private static final String DATABASE_NAME = "test.db";
	// 数据库版本号
	// 注意：版本更新涉及到“增”“删”“更改”表时，需小心维护版本号DATABASE_VERSION和升级方法onUpgrade
	private static final int DATABASE_VERSION = 3;

	public DataBaseHelper(Context context) {
		super(context, DATABASE_NAME, null, DATABASE_VERSION);
	}

	// 创建数据库的表们
	private void createTables(SQLiteDatabase db) {
		// 活动提醒
		db.execSQL(ActivityRemindDatabase.CREATE_TABLE_COMMAND);
		// 消息中心
		db.execSQL(PushMsgDatabase.CREATE_TABLE_COMMAND);
	}

	@Override
	public void onCreate(SQLiteDatabase database) {
		createTables(database);
	}

	/*
	 * 注意：版本更新涉及到“增”“删”“更改”表时，需小心维护版本号DATABASE_VERSION和升级方法onUpgrade
	 */
	@Override
	public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
		switch (oldVersion) {
		// 从版本1升级到当前版本
		case 1:
			// 活动提醒
			db.execSQL(ActivityRemindDatabase.CREATE_TABLE_COMMAND);
			// 消息中心
			db.execSQL(PushMsgDatabase.CREATE_TABLE_COMMAND);
			break;

		// 从版本2升级到当前版本
		case 2:
			// 消息中心
			db.execSQL(PushMsgDatabase.CREATE_TABLE_COMMAND);
			break;

		default:
			// 没有小心维护数据库时，添加的保护代码
			createTables(db);
			break;
		}
	}

}
